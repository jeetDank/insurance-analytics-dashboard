<div class="mt-2">
  <p-accordion [value]="0" class="dark-accordion">
    @for (tab of tabs; track tab.title) {
      <p-accordion-panel 
        class="mt-3 shadow-sm rounded-2 overflow-hidden dark-panel"
        [value]="tab.value"
      >
        <p-accordion-header class="dark-header">
          <div class="w-100 d-flex gap-2 rounded-2 align-items-center">
            <div class="text-success">
              <i [class]="tab.icon" style="font-size: 1.5rem"></i>
            </div>
            <div class="text-primary">{{ tab.title }}</div>
            <p-tag
              class="ms-auto me-3 fw-normal dark-tag"
              icon="pi pi-sparkles"
              severity="secondary"
              value="Specialized Analysis"
            ></p-tag>
          </div>
        </p-accordion-header>

        <p-accordion-content class="dark-content">
          <div class="fs-6 mb-3 text-secondary">{{ tab.subTitle }}</div>

          <div class="steps-container">
            <p-accordion>
              @for (step of tab.steps; track step.id) {
                <p-accordion-panel [value]="step.id" class="mb-3 dark-panel">
                  <p-accordion-header class="dark-header">
                    <div class="d-flex align-items-center gap-2 w-100">
                      <div class="flex-grow-1">
                        <div class="d-flex align-items-center gap-2 mb-1">
                          @if (step.icon) {
                            <i
                              [class]="step.icon"
                              class="text-success"
                              style="font-size: 1.25rem"
                            ></i>
                          }
                          <h6 class="mb-0 text-primary">{{ step.title }}</h6>
                          @if (step.tag) {
                            <p-tag
                              [value]="step.tag"
                              [icon]="step.tagIcon || ''"
                              severity="contrast"
                              class="fw-medium ms-auto me-2 dark-tag"
                              [style]="{
                                'font-size': '0.75rem',
                                'background': 'rgba(255,255,255,0.05)',
                                'color': 'var(--text-primary)',
                                'border': '1px solid var(--color-border)'
                              }"
                            />
                          }
                        </div>
                      </div>
                    </div>
                  </p-accordion-header>

                  <p-accordion-content class="dark-content">
                    @if (step.subTitle) {
                      <p class="text-muted mb-2 small">{{ step.subTitle }}</p>
                    }
                    @if (step.list) {
                      <div>
                        <p-accordion>
                          @for (subList of step.list; track $index) {
                            <div class="d-flex align-items-center gap-2 w-100">
                              @if (subList.listIcon) {
                                <i [class]="subList.listIcon" class="text-primary"></i>
                              }
                              @if (subList.listTitle) {
                                <strong class="small mt-2 mb-2 text-secondary">{{ subList.listTitle }}</strong>
                              }
                            </div>

                            @if (subList.list) {
                              <ul class="list-unstyled ms-3">
                                @for (item of subList.list; track $index) {
                                  <li class="mb-2 d-flex align-items-start gap-2">
                                    @if (item.itemIcon) {
                                      <i
                                        [class]="item.itemIcon"
                                        class="mt-1 text-secondary"
                                        style="font-size: 0.875rem"
                                      ></i>
                                    }
                                    @if (item.itemTitle) {
                                      <span class="small text-primary">{{ item.itemTitle }}</span>
                                    }
                                  </li>
                                }
                              </ul>
                            }
                          }
                        </p-accordion>
                      </div>
                    }
                  </p-accordion-content>
                </p-accordion-panel>
              }
            </p-accordion>
          </div>
        </p-accordion-content>
      </p-accordion-panel>
    }
  </p-accordion>
</div>
